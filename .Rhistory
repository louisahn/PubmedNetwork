visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
visNodes(color = list(background = "lightblue"
#, hover = list(background = "green", border = "orange")
)
,shadow = list(enabled = TRUE, size = 10)
) %>%
visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visGroups(groupname = "Authors", color = 'orange') %>%
visGroups(groupname = "Industry", color = "darkred") %>%
#  visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
visNodes(color = list(background = "lightblue"
, hover = list(background = "green", border = "orange")
)
,shadow = list(enabled = TRUE, size = 10)
) %>%
visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visGroups(groupname = "Authors", color = 'orange') %>%
visGroups(groupname = "Industry", color = "darkred") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
#  visNodes(color = list(background = "lightblue"
#                        , hover = list(background = "green", border = "orange")
#                        )
#           ,shadow = list(enabled = TRUE, size = 10)
) %>%
visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visGroups(groupname = "Authors", color = 'orange') %>%
visGroups(groupname = "Industry", color = "darkred") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
#  visNodes(color = list(background = "lightblue"
#                        , hover = list(background = "green", border = "orange")
#                        )
#           ,shadow = list(enabled = TRUE, size = 10)
#  ) %>%
visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visGroups(groupname = "Authors", color = 'orange') %>%
visGroups(groupname = "Industry", color = "darkred") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
#  visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
#  visNodes(color = list(background = "lightblue"
#                        , hover = list(background = "green", border = "orange")
#                        )
#           ,shadow = list(enabled = TRUE, size = 10)
#  ) %>%
visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visGroups(groupname = "Authors", color = 'orange') %>%
visGroups(groupname = "Industry", color = "darkred") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
#  visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
#  visEdges(smooth = FALSE) %>%
#  visNodes(color = list(background = "lightblue"
#                        , hover = list(background = "green", border = "orange")
#                        )
#           ,shadow = list(enabled = TRUE, size = 10)
#  ) %>%
visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visGroups(groupname = "Authors", color = 'orange') %>%
visGroups(groupname = "Industry", color = "darkred") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
#  visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
#  visEdges(smooth = FALSE) %>%
#  visNodes(color = list(background = "lightblue"
#                        , hover = list(background = "green", border = "orange")
#                        )
#           ,shadow = list(enabled = TRUE, size = 10)
#  ) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visGroups(groupname = "Authors", color = 'orange') %>%
visGroups(groupname = "Industry", color = "darkred") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
#  visEdges(smooth = FALSE) %>%
#  visNodes(color = list(background = "lightblue"
#                        , hover = list(background = "green", border = "orange")
#                        )
#           ,shadow = list(enabled = TRUE, size = 10)
#  ) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visGroups(groupname = "Authors", color = 'orange') %>%
visGroups(groupname = "Industry", color = "darkred") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
#  visEdges(smooth = FALSE) %>%
#  visNodes(color = list(background = "lightblue"
#                        , hover = list(background = "green", border = "orange")
#                        )
#           ,shadow = list(enabled = TRUE, size = 10)
#  ) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
%>% visGroups(groupname = "Authors", color = 'orange') %>%
visGroups(groupname = "Industry", color = "darkred") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
#  visEdges(smooth = FALSE) %>%
#  visNodes(color = list(background = "lightblue"
#                        , hover = list(background = "green", border = "orange")
#                        )
#           ,shadow = list(enabled = TRUE, size = 10)
#  ) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visGroups(groupname = "Authors", color = 'orange') %>%
visGroups(groupname = "Industry", color = "darkred") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
#  visEdges(smooth = FALSE) %>%
#  visNodes(color = list(background = "lightblue"
#                        , hover = list(background = "green", border = "orange")
#                        )
#           ,shadow = list(enabled = TRUE, size = 10)
#  ) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visLegend()  %>%
visGroups(groupname = "Authors", color = 'orange') %>%
visGroups(groupname = "Industry", color = "darkred") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
#  visEdges(smooth = FALSE) %>%
#  visNodes(color = list(background = "lightblue"
#                        , hover = list(background = "green", border = "orange")
#                        )
#           ,shadow = list(enabled = TRUE, size = 10)
#  ) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
nb <- 10
nodes <- data.frame(id = 1:nb, label = paste("Label", 1:nb),
group = sample(LETTERS[1:3], nb, replace = TRUE), value = 1:nb,
title = paste0("<p>", 1:nb,"<br>Tooltip !</p>"), stringsAsFactors = FALSE)
edges <- data.frame(from = trunc(runif(nb)*(nb-1))+1,
to = trunc(runif(nb)*(nb-1))+1,
value = rnorm(nb, 10), label = paste("Edge", 1:nb),
title = paste0("<p>", 1:nb,"<br>Edge Tooltip !</p>"))
visNetwork(nodes, edges, width = "100%") %>% visLegend()
nodes_from <- as.data.frame(table(title =edges_df$source ))
nodes_to <- as.data.frame(table(title =edges_df$target))
#nodes_from <- as.data.frame(table(name=edges$from, nName=edges$co_name, Group=edges$coi_type ))
#nodes_to <- as.data.frame(table(name=edges$to, nName=edges$author_name))
#nodes_to["Group"]="Authors"
nodes_to = nodes_to %>%
mutate(group = "Authors")
nodes_from = nodes_from %>%
mutate(group = "Industry")
nodes_df <- rbind(nodes_from , nodes_to )
#drop rows that freq is 0
nodes_df = nodes_df[nodes_df$Freq != 0,]
#idx create
nodes = nodes_df %>%
mutate(id = row_number()) %>%
mutate(value = Freq)
#create from, to in edges
edges = edges_df %>%
left_join(nodes %>% rename(from = id), by=c('source' = 'title')) %>%
left_join(nodes %>% rename(to = id), by=c('target' = 'title'))
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visLegend()  %>%
visGroups(groupname = "Authors", color = 'orange') %>%
visGroups(groupname = "Industry", color = "darkred") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
#  visEdges(smooth = FALSE) %>%
#  visNodes(color = list(background = "lightblue"
#                        , hover = list(background = "green", border = "orange")
#                        )
#           ,shadow = list(enabled = TRUE, size = 10)
#  ) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visLegend()  %>%
visGroups(groupname = "Authors" ) %>%
visGroups(groupname = "Industry") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
#  visEdges(smooth = FALSE) %>%
#  visNodes(color = list(background = "lightblue"
#                        , hover = list(background = "green", border = "orange")
#                        )
#           ,shadow = list(enabled = TRUE, size = 10)
#  ) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visLegend()  %>%
visGroups(groupname = "Authors" ) %>%
visGroups(groupname = "Industry") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
#  visNodes(color = list(background = "lightblue"
#                        , hover = list(background = "green", border = "orange")
#                        )
#           ,shadow = list(enabled = TRUE, size = 10)
#  ) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visLegend()  %>%
visGroups(groupname = "Authors" ) %>%
visGroups(groupname = "Industry") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = TRUE) %>%
#  visNodes(color = list(background = "lightblue"
#                        , hover = list(background = "green", border = "orange")
#                        )
#           ,shadow = list(enabled = TRUE, size = 10)
#  ) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
FALSE
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visLegend()  %>%
visGroups(groupname = "Authors" ) %>%
visGroups(groupname = "Industry") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
#  visNodes(color = list(background = "lightblue"
#                        , hover = list(background = "green", border = "orange")
#                        )
#           ,shadow = list(enabled = TRUE, size = 10)
#  ) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visLegend()  %>%
visGroups(groupname = "Authors" ) %>%
visGroups(groupname = "Industry") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
visNodes(color = list(background = "lightblue"
, hover = list(background = "green", border = "orange")
)
,shadow = list(enabled = TRUE, size = 10)
) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visLegend()  %>%
visGroups(groupname = "Authors" ) %>%
visGroups(groupname = "Industry") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_nicely") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
visNodes(color = list(background = "lightblue"
, hover = list(background = "green", border = "red")
)
,shadow = list(enabled = TRUE, size = 10)
) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visLegend()  %>%
visGroups(groupname = "Authors" ) %>%
visGroups(groupname = "Industry") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_with_fr") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
visNodes(color = list(background = "lightblue"
, hover = list(background = "green", border = "red")
)
,shadow = list(enabled = TRUE, size = 10)
) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visLegend()  %>%
visGroups(groupname = "Authors" ) %>%
visGroups(groupname = "Industry") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_with_kk") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
visNodes(color = list(background = "lightblue"
, hover = list(background = "green", border = "red")
)
,shadow = list(enabled = TRUE, size = 10)
) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visLegend()  %>%
visGroups(groupname = "Authors" ) %>%
visGroups(groupname = "Industry") %>%
visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_with_lgl") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
visNodes(color = list(background = "lightblue"
, hover = list(background = "green", border = "red")
)
,shadow = list(enabled = TRUE, size = 10)
) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
View(nodes)
View(nodes)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visLegend()  %>%
visGroups(groupname = "Authors" ) %>%
visGroups(groupname = "Industry") %>%
#visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_with_lgl") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
visNodes(color = list(background = "lightblue"
, hover = list(background = "green", border = "red")
)
,shadow = list(enabled = TRUE, size = 10)
) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visLegend()  %>%
visGroups(groupname = "Authors", color = darkblue) %>%
visGroups(groupname = "Industry" , color = red) %>%
#visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_with_lgl") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
visNodes(color = list(background = "lightblue"
, hover = list(background = "green", border = "red")
)
,shadow = list(enabled = TRUE, size = 10)
) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visGroups(groupname = "Industry" , color = 'red'') %>%
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visLegend()  %>%
visGroups(groupname = "Authors", color = 'darkblue') %>%
visGroups(groupname = "Industry" , color = 'red') %>%
#visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_with_lgl") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
visNodes(color = list(background = "lightblue"
, hover = list(background = "green", border = "red")
)
,shadow = list(enabled = TRUE, size = 10)
) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visLegend()  %>%
visGroups(groupname = "Authors", color = "darkblue") %>%
visGroups(groupname = "Industry" , color = "red") %>%
#visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_with_lgl") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
visNodes(color = list(background = "lightblue"
, hover = list(background = "green", border = "red")
)
,shadow = list(enabled = TRUE, size = 10)
) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
#Get pmid from  API
pmidlist = list()
#Alirocumab leukemia Lukemia
temp <- esearch("leukemia",db="pubmed",retmode = "json", retstart = 0, retmax = "100000", datetype = "pdat",mindate = "2015",maxdate = "2018")
tempdata <- fromJSON(content(temp))
pmidlist <- append(pmidlist,tempdata$esearchresult$idlist)
# Build query with pmid list
query_pmid_list = paste(pmidlist,collapse = "','")
query_pmid_list_where = paste("'", query_pmid_list , "'" )
query = paste('select pmid, cid, aid
, author_name  as "target"
, co_name  as "source"
, coi_type, co_name
, weight as Weight
, industry_type
from edges_master where pmid IN (',query_pmid_list_where,')')
# Execute Query
edges_df = dbGetQuery(connection,query)
nodes_from <- as.data.frame(table(title =edges_df$source ))
nodes_to <- as.data.frame(table(title =edges_df$target))
#nodes_from <- as.data.frame(table(name=edges$from, nName=edges$co_name, Group=edges$coi_type ))
#nodes_to <- as.data.frame(table(name=edges$to, nName=edges$author_name))
#nodes_to["Group"]="Authors"
nodes_to = nodes_to %>%
mutate(group = "Authors")
nodes_from = nodes_from %>%
mutate(group = "Industry")
nodes_df <- rbind(nodes_from , nodes_to )
#drop rows that freq is 0
nodes_df = nodes_df[nodes_df$Freq != 0,]
#idx create
nodes = nodes_df %>%
mutate(id = row_number()) %>%
mutate(value = Freq)
#create from, to in edges
edges = edges_df %>%
left_join(nodes %>% rename(from = id), by=c('source' = 'title')) %>%
left_join(nodes %>% rename(to = id), by=c('target' = 'title'))
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visLegend()  %>%
visGroups(groupname = "Authors", color = "darkblue") %>%
visGroups(groupname = "Industry" , color = "red") %>%
#visOptions(highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
addFontAwesome() %>%
visPhysics(stabilization = FALSE) %>%
visIgraphLayout(layout = "layout_with_lgl") %>%
# layout_nicely,ifelse(input$layout == "2", layout_with_fr, ifelse(input$layout == "3", layout_with_kk, ifelse(input$layout == "4", layout_in_circle, layout_with_lgl)))),
visEdges(smooth = FALSE) %>%
visNodes(color = list(background = "lightblue"
, hover = list(background = "green", border = "red")
)
,shadow = list(enabled = TRUE, size = 10)
) %>%
#  visInteraction(hover = TRUE)  %>%
visLayout(randomSeed = 123)
